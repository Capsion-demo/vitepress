# Vueä¸­çš„ç»„ä»¶é€šè®¯

ç»„ä»¶ä¸ç»„ä»¶é—´å¸¸å‡ºç°çš„å…³ç³»ï¼š

![image-20211216153245716](https://gitee.com/capsion/markdown-image/raw/master/image/202112161533364.png)

ä¸Šæ—è°±ğŸ“œï¼š

- çˆ¶å­å…³ç³»ï¼šAå’ŒAAï¼ŒAAå’ŒAAAï¼ŒBå’ŒBBã€BBå’ŒBBB
- å…„å¼Ÿå…³ç³»ï¼šAå’ŒB
- çˆ·å­™å…³ç³»ï¼šAå’ŒAAAã€Bå’ŒBBB
- é‚»å±…å…³ç³»ï¼šAå’ŒBå†…ä»»æ„ï¼ŒBä¸Aå†…ä»»æ„



## å¸¸ç”¨çš„é€šè®¯æ–¹å¼

| åç§°         |  è¯´æ˜             |
| ------------------------- |  ------------------ |
| Prop å’Œ $emit             | **å•å‘æ•°æ®æµ**ï¼Œå®˜æ–¹æ¨èï¼Œæœ€åŸºç¡€ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ä¼ è¾“æ‰‹æ®µ |
| eventBus | **äº‹ä»¶æ€»çº¿**ï¼Œè€¦åˆä½ï¼Œä½†æ˜¯ç”¨å¤šäº†ä¼šè®©ä¸šåŠ¡ä»£ç åˆ†æ•£åˆ°å„å¤„ï¼Œéœ€è¦å¦å¤–å®šåˆ¶ä¸€äº›å›¢é˜Ÿè§„åˆ™ |
| vuex                      | å®˜æ–¹å‡ºå“çš„å…¨å±€çŠ¶æ€ç®¡ç†åº“ |
| pinia | æ–°ä¸€ä»£çš„vueçŠ¶æ€ç®¡ç†ï¼ˆ2021å¹´æœ«ï¼‰ |



## ä¸å¸¸ç”¨çš„é€šè®¯æ–¹å¼ï¼ˆä¸æ¨èï¼‰

| åç§°                               | è¯´æ˜                                                         |
| ---------------------------------- | ------------------------------------------------------------ |
| $parent ã€ $children               | ç›´æ¥è®¿é—®çˆ¶å­å®ä¾‹ä¸Šçš„æ–¹æ³•æˆ–è€…å±æ€§ï¼Œæ„Ÿè§‰æ¯”è¾ƒä¸å®‰å…¨ï¼Œå°‘ç”¨       |
| $refs                              | ç”¨æ¥æ“ä½œDOMå¸¸ç”¨ï¼Œå…¶å®ä¹Ÿå¯ä»¥ç”¨æ¥è·Ÿä¸Šä¸‹æ–‡çš„ç»„ä»¶é€šè®¯ï¼Œä¹Ÿæ˜¯å°‘ç”¨  |
| provide ã€ inject                  | 2.2 æ–°å¢ï¼Œå®˜æ–¹ä¸å»ºè®®ç”¨åœ¨æ—¥å¸¸ä¸šåŠ¡ç»„ä»¶ä¸­ï¼Œå»ºè®®ç”¨åœ¨ç»„ä»¶åº“å°è£…æ—¶ |
| $attrs ã€ $listenersã€inheritAttrs | 2.4 æ–°å¢ï¼Œå®˜æ–¹æ¨èåœ¨ä¸€äº›ç»„ä»¶å°è£…çš„åœ°æ–¹ä½¿ç”¨ï¼Œæ—¥å¸¸ç”¨ä¼šæœ‰é‡å¤è§¦å‘äº‹ä»¶çš„å‘ï¼Œéœ€è¦å»é‡ |



> PSï¼šè™½ç„¶æ–¹æ³•æœ‰è¿™ä¹ˆå¤šï¼Œä½†æ˜¯å›¢é˜Ÿä¸­æ¯æ¬¡å¼€å‘é¡¹ç›®åº”è¯¥ç»Ÿä¸€æŒ‡å®šä¸€ç§åˆ°ä¸¤ç§ä¸»è¦é€šè®¯æ–¹å¼ï¼Œè¿™æ ·æ–¹ä¾¿åç»­é¡¹ç›®ç»´æŠ¤å’Œå‡çº§ã€‚

> ä¸æ¨èçš„æ–¹å¼æœ‰çš„æ˜¯æ·˜æ±°çš„ï¼Œæœ‰çš„æ˜¯ä¸ä¾¿äºå›¢é˜ŸåæœŸç»´æŠ¤çš„ï¼Œç”¨æ˜¯èƒ½ç”¨ï¼Œä½†æ˜¯å¤šå°‘æœ‰ç‚¹é—¨æ§›æˆ–è€…è¦ç»™é¡¹ç›®å¸¦æ¥é¢å¤–çš„ç»´æŠ¤æˆæœ¬ã€‚



## 1ã€Prop ã€ $emit

å•å‘æ•°æ®æµ

çˆ¶ç»„ä»¶é€šè¿‡ç»‘å®šåŒåçš„propså‚æ•°ï¼Œå°†æ•°æ®å‘å­ç»„ä»¶ä¼ é€’ï¼Œé€šè¿‡ç›‘å¬å­ç»„ä»¶çš„emitè§¦å‘çš„äº‹ä»¶æ¥æ›´æ–°è‡ªèº«æ•°æ®ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å•å‘çš„ï¼Œä¹Ÿç§°ä¸ºå•å‘æ•°æ®æµ

### å¦‚ä½•ä½¿ç”¨(vue2)

```vue
<template lang="pug">
	Child1(v-bind:param1="param1")
</template>
```


```vue
<script>
import Vue from "Vue"
let parent = new Vue({
    el:'#app',
    name:"parent",
    data(){
        return{
            param1:"1",
            param2:"2"
        }
    },
    method:{
        // çˆ¶ç»„ä»¶ä¿®æ”¹æ•°æ®æš´éœ²çš„æ¥å£
        parentChangeData({param, newValue}){
            this[param] = newValue
        }
    }
    components:{
        'Child1':{
            props:['param1'],
            template:`<div>å­ç»„ä»¶ï¼š{{param1}}</div>`,
            method:{
                changeData(){
    			  // ä½¿ç”¨emitè§¦å‘çˆ¶ç»„ä»¶æš´éœ²çš„æ–¹æ³•æ¥ä¿®æ”¹æ•°æ®
                    this.$emit('parentChangeData',{})
                }
            }
        }
    }
})
</script>
```




- vue3



## 2ã€$parent ã€ $children

å‚é˜…èµ„æ–™ï¼š[$parent/$childrençš„ä½¿ç”¨åœºæ™¯](https://juejin.cn/post/6896783432932655112)

### å¦‚ä½•ä½¿ç”¨

```vue
<template lang="pug">
	Child1(v-bind:param1="param1")
</template>
```

```js
export default {
    name:"parent-component",
    data(){
        return{
            parentData:"data",
        }
    },
    components:{
        'Child1':{
            template:`<div>å­ç»„ä»¶ï¼š{{param1}}</div>`,
            beforeMount(){
                this.getParentData()
            },
            data (){
                return{
                    childData:"",
                }
            },
            method:{
                getParentData(){
                    this.childData = this.$parent.parentData
                }
            }
        }
    }
}
```



### æ³¨æ„äº‹é¡¹

- æ¸²æŸ“çš„æ—¶å€™å…ˆå­ç»„ä»¶çš„`mounted`ï¼Œç„¶åå†æ˜¯è‡ªå·±çš„`mounted`è¦æ˜¯æƒ³åœ¨å­ç»„ä»¶é‡Œè·å–çˆ¶ç»„ä»¶çš„å…ƒç´ ä¹‹ç±»çš„ï¼Œå¿…é¡»ä½¿ç”¨`nextTick`
- `$children` å¹¶ä¸ä¿è¯é¡ºåºï¼Œä¹Ÿä¸æ˜¯å“åº”å¼çš„ã€‚**å¦‚æœä½ å‘ç°è‡ªå·±æ­£åœ¨å°è¯•ä½¿ç”¨ `$children` æ¥è¿›è¡Œæ•°æ®ç»‘å®šï¼Œè€ƒè™‘ä½¿ç”¨ä¸€ä¸ªæ•°ç»„é…åˆ `v-for` æ¥ç”Ÿæˆå­ç»„ä»¶ï¼Œå¹¶ä¸”ä½¿ç”¨ Array ä½œä¸ºçœŸæ­£çš„æ¥æºã€‚



### é€‚ç”¨åœºæ™¯

- å°è£…åµŒå¥—ç»„ä»¶æ—¶ï¼Œç›´æ¥ä½¿ç”¨é•¿è¾ˆæˆ–è€…å­å­™ç»„ä»¶çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¹¶ä¸æ”¹å˜æ•°æ®ï¼Œå¸¸å¸¸ç»“åˆ`$broadcast/$dispatch`ä½¿ç”¨ï¼ˆå®˜æ–¹å·²å¼ƒç”¨ï¼‰



## 3ã€$attrs ã€ $listenersã€inheritAttrs 

`vue3ç§»é™¤$listeners`

`åœºæ™¯é™åˆ¶` `2.4`  `äºŒæ¬¡å°è£…`

å‚é˜…èµ„æ–™ï¼š[Vueä½¿ç”¨$attrsä¸$listenerså®ç°å¤šå±‚åµŒå¥—ä¼ é€’](https://juejin.cn/post/6844903828098138120)

### ç”¨æ³•

```vue
<component v-bind="$attrs" v-on="$listeners"></component>
```

ä¼ ç»Ÿçˆ¶ç»„ä»¶è¦ä¼ é€’å±æ€§ç»™å­™ç»„ä»¶éœ€è¦å…ˆç»è¿‡å­ç»„ä»¶å®šä¹‰propsæ¥é€å±‚ä¼ é€’ï¼Œåœ¨é«˜å±‚çº§çš„ä¸šåŠ¡åœºæ™¯ä¸‹éå¸¸ä¸æ–¹ä¾¿ï¼Œè€Œä½¿ç”¨$attrså¯ä»¥åšåˆ°çˆ¶ç»„ä»¶ç›´æ¥ä¼ é€’åˆ°ä¸‹çº§å¤šå±‚ç»„ä»¶ä¸­ï¼Œå¤§å¤§å‡å°‘äº†å±‚çº§å¸¦æ¥çš„é€å±‚ä¼ é€’é—®é¢˜å…³ç³»ã€‚



```vue
<template lang="pug">
	Child1(v-bind:param1="param1")
</template>

<script>
/* é¡¶å±‚ç»„ä»¶ */
let parent = new Vue({
    el:'#app',
    name:"parent",
    data(){
        return{
            param1:"1",
            param2:"2",
        }
    },
    methods:{
        // é¡¶å±‚ç»„ä»¶æš´éœ²ä¸€ä¸ªä¿®æ”¹å±æ€§çš„æ–¹æ³•
        changeData(newData){
            this.param2 = newData
        }
    }
    /* ä¸­å±‚ç»„ä»¶ */
    components:{
        'Child1':{
            // ä¸­å±‚ç»„ä»¶ä¸éœ€é‡å¤å®šä¹‰propsï¼Œåªéœ€è¦æ·»åŠ å›ºå®šçš„ v-bind="$arrts"ã€v-on="$listeners"
            template:`<Child2 v-bind="$arrts" v-on="$listeners"></Child2>`,
    
    		/* ä¸‹å±‚ç»„ä»¶ */
            components:{
                'Child2':{
                    props:['param2'] // ä¸‹å±‚ç»„ä»¶ä¾ç„¶å°±èƒ½å¾—åˆ°param2ï¼Œå’Œè§¦å‘changeData
                    template:`<div>æˆ‘æ˜¯å­™ç»„ä»¶æˆ‘ä»¬ç›´æ¥ä½¿ç”¨param1 {{param1}}</div>`,
                    methods:{
                    	setParentData(){
    					  // ä¸‹å±‚ç»„ä»¶ç›´æ¥èƒ½ä½¿ç”¨ $emit æ¥è§¦å‘é¡¶å±‚ç»„ä»¶çš„æ–¹æ³•
                            this.$emit('changeData', this.param2)
                        }
                    }
                }
            }
        }
    }
})
</script>
```



### å‘

- å®˜æ–¹æ¨è `$listener` çš„åº”ç”¨åœºæ™¯æ˜¯äºŒæ¬¡æ–¹çŠ¶çš„ç»„ä»¶ä¸Šï¼Œæ‰€ä»¥éå¿…è¦å°½é‡ä¸è¦é‡‡ç”¨æ­¤ç§æ–¹å¼ä½œä¸ºç»„ä»¶é€šè®¯çš„é¦–é€‰

  - [å®˜æ–¹è§£é‡Š](https://cn.vuejs.org/v2/guide/components-custom-events.html#%E5%B0%86%E5%8E%9F%E7%94%9F%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A%E5%88%B0%E7%BB%84%E4%BB%B6)
  - [æ¡ˆä¾‹](https://juejin.cn/post/6971111235588882462https://juejin.cn/post/6971111235588882462)

  



## 4ã€provide å’Œ inject (2.2 åŠ å…¥)





## 5ã€$refs æ“ä½œç»„ä»¶å®ä¾‹



## 6ã€eventBus äº‹ä»¶æ€»çº¿ï¼ˆæ¨èï¼‰

äº‹ä»¶æ€»çº¿æ˜¯å®˜æ–¹æ¨èçš„å…¶ä»ä¸€å¥—ç»„ä»¶é€šè®¯è§£å†³æ–¹æ¡ˆï¼šç‚¹æˆ‘è·³è½¬()



## 7ã€vuex 


æ€»ç»“
